@startuml robustness_predict_worker
!theme plain
title Robustness Diagram: Predict Worker

skinparam backgroundColor #FEFEFE
skinparam defaultFontName Arial
skinparam defaultFontSize 11

actor "Task Orchestrator" as Orchestrator
boundary "ML Service API" as MLAPI
control "Worker Prediction Engine" as PredictEngine
entity "Worker Prediction Model" as PredictModel
entity "Worker Status DB" as WorkerDB
entity "Execution Records DB" as RecordsDB

Orchestrator --> MLAPI : 1: predictWorker(taskType, taskMetadata)
MLAPI --> PredictEngine : 2: predict(task, worker_metrics)
PredictEngine --> WorkerDB : 3: getWorkerStatus()
WorkerDB --> PredictEngine : 4: {worker_cpu, memory, queue_depth}
PredictEngine --> PredictModel : 5: loadModel()
PredictModel --> PredictEngine : 6: model loaded
PredictEngine --> PredictModel : 7: extract_features(task, workers)
PredictModel --> PredictModel : 8: forward_pass(features)
PredictModel --> PredictEngine : 9: {best_worker, duration_estimate, confidence}

alt Prediction Success
  PredictEngine --> RecordsDB : 10: storePrediction(taskID, prediction)
  RecordsDB --> PredictEngine : 11: confirmed
end

PredictEngine --> MLAPI : 12: {workerID, estimated_duration, confidence}
MLAPI --> Orchestrator : 13: worker prediction result

note right of Orchestrator
  Task Orchestrator
  requests optimal
  worker prediction
end note

note right of MLAPI
  Boundary object
  ML service API
  Real-time predictions
end note

note right of PredictEngine
  Control logic that:
  - Gets worker status
  - Loads prediction model
  - Extracts features
  - Runs inference
  - Estimates duration
end note

note right of PredictModel
  Entity object
  Worker Prediction Model
  Trained on 1000 records
  100% accuracy proven
  
  Input: Task type + worker load
  Output: Best worker + ETA
end note

note right of WorkerDB
  Entity object
  Real-time worker metrics
  - CPU usage
  - Memory usage
  - Task queue
  - Success rate
end note

note right of RecordsDB
  Entity object
  Stores predictions
  for learning and
  accuracy evaluation
end note

@enduml
