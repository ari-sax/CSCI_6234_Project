@startuml
title Activity Diagram: Classify Tasks
skinparam monochrome true
skinparam shadowing false

start

partition "Task Orchestrator" {
  :1. Request classification for a pending Task;
}

partition "ML Service" {
  :2. Receive classification request;
  :3. Load Task Classification model;
  :4. Extract features from Task metadata;
  :5. Predict TaskType + confidence;
  if (6. Confidence >= threshold?) then (Yes)
    :7. Create Prediction (type, confidence);
  else (No)
    :7a. Apply rule-based fallback classification;
  endif
}

partition "Database" {
  :8. Persist TaskClassification (predicted + actual placeholder);
  :9. Update Task with predicted TaskType;
}

partition "Task Orchestrator" {
  :10. Continue workflow (next: predict worker / schedule);
}

note
TEXT DESCRIPTION (step-to-action mapping):
1) Step numbers in each action (e.g., "1.", "2.", ...) correspond to the written steps here.
2) Each written step corresponds to exactly one action in the diagram, in the same order.
end note

stop
@enduml
